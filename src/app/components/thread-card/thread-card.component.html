<div class="thread-card">
  <div class="thread-content">
    <!-- Thread Title -->
    <h3 class="thread-title">
      <a [routerLink]="['/thread', thread.id]">
        {{ thread.title }}
      </a>
    </h3>

    <!-- Description: Show preview or full based on expanded -->
    <p class="thread-snippet" *ngIf="!expanded">
      {{ getPreview(thread.description) }}
      <a href="#" (click)="expanded = true; $event.preventDefault()">Read more</a>
    </p>
    <p class="thread-description" *ngIf="expanded">
      {{ thread.description }}
    </p>

    <!-- Tags -->
    <div class="thread-tags" *ngIf="thread.tags?.length">
      <span *ngFor="let tag of (isArray(thread.tags) ? thread.tags : thread.tags.split(','))" class="tag-label">{{ tag }}</span>
    </div>

    <!-- Action Buttons -->
    <div class="thread-actions">
      <button class="action-btn like-btn" (click)="onLike()">Like</button>
      <button class="action-btn dislike-btn" (click)="onDislike()">Dislike</button>
      <button class="action-btn reply-btn" (click)="onReply()">Reply</button>
    </div>

    <!-- Registration Modal (pseudo) -->
    <app-user-register
      *ngIf="showRegisterModal"
      (registerSuccess)="onRegisterSuccess()"
      (close)="showRegisterModal = false">
    </app-user-register>

    <!-- Reply Box -->
    <div *ngIf="showReplyBox" class="reply-box">
      <textarea
        [(ngModel)]="replyText"
        placeholder="Write your reply..."
        rows="4"
      ></textarea>
      <button (click)="submitReply()">Submit</button>
    </div>
  </div>

  <!-- Stats on the Right -->
  <div class="thread-stats">
    <div>Likes {{ thread.likes }}</div>
    <div>Dislikes {{ thread.dislikes }}</div>
    <div>
      Replies
      <ng-container *ngIf="isArray(thread.replies); else replyCount">
        {{ thread.replies.length }}
      </ng-container>
      <ng-template #replyCount>
        {{ thread.replies || 0 }}
      </ng-template>
    </div>
  </div>
</div>